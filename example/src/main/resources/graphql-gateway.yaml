schema:
  typeDefs: "./schema.graphql"
  resolvers:
    Query:
      getUser: "./getUser.js"
      getOrder: "./getOrder.js"
    Mutation:
      updateUser: "./updateUser.py"

scalars:
  - name: "File"
    description: "A file part in a multipart request"
  - name: "Upload"
    description: "A file part in a multipart request"

services:
  - name: asany
    url: "https://api.asany.cn/graphql"
#    typeDefs: "./user-service.graphql"
    override:
      - type: "Query"
        fields:
          - name: "applications"
            rename: "apps"
            dataLoader: true
            dataFetcher: "batch"
            arguments:
              - name: "where"
                rename: "filter"
          - name: "testApp"
            dataFetcher: "single"
            type: "Application"
            arguments:
              - name: "input"
                description: "test app input"
                type: "EnhancedUserInput!"
      - type: "Application"
        fields:
          - name: "name"
            rename: "appName"
          - name: "layoutRoute"
            ignore: true

dataFetchers:
  - name: "batch"
    type: "spring"
    bean: "batchDataFetcher"
  - name: "single"
    type: "javascript"
    resolver: "./singleDataFetcher.js"

rewriteFields:
  - field: "User.addUser"
    definition: "addUser(input: EnhancedUserInput): EnhancedUser"
    delegate:
      name: getUser
      args:
        id: "$.id"

delegates:
  - name: getUser
    resolver: "./getUser.js"

rewriteRules:
  - match:
      queryName: "getUser"
    rewrite:
      toService: "userService"
      modifyQuery: "replaceUserIdWithUsername"

  - match:
      queryName: "getOrder"
    rewrite:
      toService: "orderService"
      modifyQuery: "addOrderDetails"

forwardingRules:
  - match:
      queryName: "getUser"
    forwardTo: "userService"

security:
  authentication:
    enabled: true
    provider: jwt
    secretKey: "your_secret_key"

  authorization:
    enabled: true
    policy: "./auth-policy.yaml"

logging:
  level: INFO
  format: json

caching:
  enabled: true
  ttl: 300

monitoring:
  enabled: true
  endpoint: "/metrics"